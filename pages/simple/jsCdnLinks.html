<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>js cdn links</title>
<script type="text/javascript">
(function(){
	var getXHRInstance = function () {
	  var xhr = null;
	  if (window.XMLHttpRequest) { // code for IE7, Firefox, Opera, etc.
		xhr = new XMLHttpRequest();
	  } else if (window.ActiveXObject) { // code for IE6, IE5
		xhr = new ActiveXObject("Microsoft.XMLHTTP");
	  }
	  return xhr;
	};
	var ajax = function(obj) {
	  if(obj!=null){
		  var options = obj;
		  if(typeof(options)=="string"){
			  options = {url:obj};
		  }else if(typeof(options)=="object"){
			  var xmlhttp = getXHRInstance();
			  var state_Change = function () {
				if (xmlhttp.readyState == 4) { // 4 = "loaded"
				  if (xmlhttp.status == 200) { // 200 = "OK"
					if(options.success && typeof(options.success)=="function"){
						(options.success)(xmlhttp.responseText,xmlhttp.status,xmlhttp.statusText);
					}
				  }
				}
			  }
			  if (xmlhttp != null) {
				xmlhttp.onreadystatechange = state_Change;
				var _method = options.method?options.method:"GET";
				xmlhttp.open(_method, options.url, true);
				xmlhttp.send(options.data);
			  }
		  }
	  }
	}
	//注册方法
	window.$$ = {
		"ajax":ajax
	};
})();

function genData(val){
	var obj = JSON.parse(val);
	if(obj!= null && obj.total>0){
		var dom_container = document.getElementById("idContainer");
		var dom_ul = document.createElement("ul");
		for(var i=0;i<obj.results.length;i++){
			var o = obj.results[i];
			var dom_li = document.createElement("li");
			var dom_a = document.createElement("a");
			dom_a.href = o.latest;
			dom_a.title = o.latest;
			dom_a.target = "_blank";
			dom_a.innerHTML = o.name;
			dom_li.appendChild(dom_a);
			dom_ul.appendChild(dom_li);
		}
		dom_container.appendChild(dom_ul);
	}
	var dom_count = document.getElementById("idTotalCount");
	dom_count.innerHTML = "共"+obj.total+"条";
}

function load(){
	$$.ajax({
		url:"../../resource/cdnjs.cloudflare.com.json",
		success:function(retVal,status,statusText){
			console.log(retVal);
			console.log(status);
			console.log(statusText);
			try{
				genData(retVal);
			}catch(e){
				console.log(e);
			}
			//end
			hideMask();
		}
	});
}
function hideMask(){
	document.getElementById("idDivMask").style.display="none";
}
</script>

<link rel="stylesheet" href="../../css/bootstrap.min.css">
<style type="text/css">
body{
	font-family:'微软雅黑','Helvetica Neue','Helvetica','Arial','sans-serif';
}
ul{
	float: left;
}
li{
	display: block;
	float: left;
    margin: 5px 10px 5px 10px;
    width: 200px;
}
a{
	color: #0088cc;
	text-decoration: none;
}

li:hover{
	border-color: rgba(215, 225, 232, 0.7);
    outline: 1px;
}


</style>

</head>
<body onload="load();" >
	<!-- 遮罩(防止页面闪烁) ,页面载入并计算完成之后,会隐藏掉 -->
	<div id="idDivMask" style="display:block;width:100%;height:100%;position:absolute;top:0px;left:0px; 
	 z-index:999999; background-color: white;" >
	 </div>
	
	<div class="container">
	<h1>js cdn links</h1>
	<h4 id="idTotalCount"></h4>
	<hr/>
	<div id="idContainer" class="container">
		<!-- 内容由js动态生成 -->
	</div>
	<hr/>
	</div>
</body>
</html>
